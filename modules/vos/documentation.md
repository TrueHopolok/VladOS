<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# vos

```go
import "github.com/TrueHopolok/VladOS/modules/vos"
```

### VladOS Security

VladOS Security \(shortly VOS\) is a package used for all security related stuff inside VladOS the project. Below are all features this package provides.

### Key Chain

TODO: add info

### Json Web Token functional

TODO: add info

### Password and Salt logic

TODO: add info

### Auth \\\- VOS sub\\\-package

TODO: add info

## Index

- [Constants](<#constants>)
- [func GenerateSalt\(\) \[\]byte](<#GenerateSalt>)
- [func NewJWT\(ses auth.Session\) \(string, error\)](<#NewJWT>)
- [func NewPSH\(password string, salt \[\]byte\) \[\]byte](<#NewPSH>)
- [func ValidateJWT\(token string\) \(auth.Session, bool, error\)](<#ValidateJWT>)
- [func ValidatePSH\(password string, salt, psh \[\]byte\) bool](<#ValidatePSH>)
- [type KeyChain](<#KeyChain>)


## Constants

<a name="EncryptionKeysSwitchingTime"></a>

```go
const (
    // Time of a keys switch in minutes.
    EncryptionKeysSwitchingTime time.Duration = 60

    // Size of a signle key in bytes.
    EncryptionKeysSize int = 64
)
```

<a name="PSH_TIME"></a>Argon2 encryption specific parameters

```go
const (
    PSH_TIME = 1
    PSH_MEM  = 64 * 1024
    PSH_THR  = 4
    PSH_LEN  = 64
)
```

<a name="JWTheader"></a>JWT header consisting of type itself and algorithm used. Currently [crypto/hmac](<https://pkg.go.dev/crypto/hmac/>) combined with [crypto.SHA512](<https://pkg.go.dev/crypto/#SHA512>) are being used.

```go
const JWTheader = `
{
  "alg": "HS512",
  "typ": "JWT"
}`
```

<a name="SaltSize"></a>Size of a salt that is generated by [GenerateSalt](<#GenerateSalt>) in bytes.

```go
const SaltSize int = 64
```

<a name="GenerateSalt"></a>
## func GenerateSalt

```go
func GenerateSalt() []byte
```

Returns completly crypto random salt to use for password hashing.

<a name="NewJWT"></a>
## func NewJWT

```go
func NewJWT(ses auth.Session) (string, error)
```

Encodes session into a new JWT.

Should never return an error, since:

- [hash.Write](<https://pkg.go.dev/hash/#Write>) never returns an error;
- [encoding/json.Marshal](<https://pkg.go.dev/encoding/json/#Marshal>) for [github.com/TrueHopolok/VladOS/modules/vos/auth.Session](<https://pkg.go.dev/github.com/TrueHopolok/VladOS/modules/vos/auth/#Session>) should not return an error.

<a name="NewPSH"></a>
## func NewPSH

```go
func NewPSH(password string, salt []byte) []byte
```

PSH \- Password Salted and Hashed. Function simplifies getting hashed password with given salt.

<a name="ValidateJWT"></a>
## func ValidateJWT

```go
func ValidateJWT(token string) (auth.Session, bool, error)
```

Returns if given JWT is valid or not. In case of being valid, parses token and returns it as [github.com/TrueHopolok/VladOS/modules/vos/auth.Session](<https://pkg.go.dev/github.com/TrueHopolok/VladOS/modules/vos/auth/#Session>) struct.

Should never return an error, since:

- [hash.Write](<https://pkg.go.dev/hash/#Write>) never returns an error;
- [encoding/json.Unmarshal](<https://pkg.go.dev/encoding/json/#Unmarshal>) works with valid marshalled [github.com/TrueHopolok/VladOS/modules/vos/auth.Session](<https://pkg.go.dev/github.com/TrueHopolok/VladOS/modules/vos/auth/#Session>) thus should not return an error;
- [encoding/base64.URLEncoding.DecodeString](<https://pkg.go.dev/encoding/base64/#URLEncoding.DecodeString>) works with valid encoded [github.com/TrueHopolok/VladOS/modules/vos/auth.Session](<https://pkg.go.dev/github.com/TrueHopolok/VladOS/modules/vos/auth/#Session>) thus should not return an error.

<a name="ValidatePSH"></a>
## func ValidatePSH

```go
func ValidatePSH(password string, salt, psh []byte) bool
```

PSH \- Password Salted and Hashed. Function simplifies validating that given PSH is for the given password and salt combination.

<a name="KeyChain"></a>
## type KeyChain

Contains 2 keys and a mutex, making it multiple goroutines save. Used solely by JWT functions.

Keys pair switch keys every [EncryptionKeysSwitchingTime](<#EncryptionKeysSwitchingTime>) minutes, thus providing additional security.

Keys pair consist of:

- current key, which is used for an encrypting and decrypting,
- previous key, which should be used only for decrypting.

Chain itself and all its methods should be used only inside VOS package.

```go
type KeyChain struct {
    // contains filtered or unexported fields
}
```

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
